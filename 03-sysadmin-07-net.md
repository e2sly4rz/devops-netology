# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

#### 1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

**Linux**

```bash
e2sly4rz@DESKTOP-43OOABH:~$ ip -c -br link
lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP>
bond0            DOWN           ca:76:d3:72:22:b0 <BROADCAST,MULTICAST,MASTER>
dummy0           DOWN           36:66:a6:2e:3c:5f <BROADCAST,NOARP>
tunl0@NONE       DOWN           0.0.0.0 <NOARP>
sit0@NONE        DOWN           0.0.0.0 <NOARP>
eth0             UP             00:15:5d:de:a7:5f <BROADCAST,MULTICAST,UP,LOWER_UP>
```

**Windows**

```powershell
PS C:\Users\e2sly> Get-NetAdapter

Name                      InterfaceDescription                    ifIndex Status       MacAddress
----                      --------------------                    ------- ------       ----------
Сетевое подключение Bl... Bluetooth Device (Personal Area Netw...      18 Disconnected C0-B5-D7-48...
vEthernet (WSL)           Hyper-V Virtual Ethernet Adapter             47 Up           00-15-5D-FE...
Подключение по локальн... TAP-Windows Adapter V9 for OpenVPN C...      10 Disconnected 00-FF-45-20...
Беспроводная сеть         Realtek 8822BE Wireless LAN 802.11ac...       8 Up           C0-B5-D7-48...
```

#### 2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

LLDP - пакет lldpd

```bash
e2sly4rz@DESKTOP-43OOABH:~$ lldpctl
-------------------------------------------------------------------------------
LLDP neighbors:
-------------------------------------------------------------------------------
```

#### 3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

VLAN - пакет vlan

```bash
e2sly4rz@DESKTOP-43OOABH:~$ sudo vim /etc/network/interfaces
auto vlan16
iface vlan16 inet static
address 172.16.16.1
netmask 255.255.255.0
vlan_raw_device eth0
```

#### 4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

- **Mode-0(balance-rr)** – сетевые пакеты отправляются от первого интерфейса к последнему по кругу. Если выходят из строя интерфейсы, пакеты отправляются на остальные оставшиеся.

- **Mode-1(active-backup)** – один из интерфейсов работает в активном режиме, остальные в ожидающем. При обнаружении проблемы на активном интерфейсе производится переключение на ожидающий интерфейс.

- **Mode-2(balance-xor)** – передача пакетов распределяется по типу входящего и исходящего трафика по формуле ((MAC src) XOR (MAC dest)) % число интерфейсов.

- **Mode-3(broadcast)** – передача во все объединенные интерфейсы. Рекомендуется только для использования MULTICAST трафика.

- **Mode-4(802.3ad)** – динамическое объединение одинаковых портов. В данном режиме можно значительно увеличить пропускную способность трафика. Необходима поддержка со стороны коммутатора.

- **Mode-5(balance-tlb)** – адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса.

- **Mode-6(balance-alb)** – адаптивная балансировка нагрузки трафика. Отличается более совершенным алгоритмом балансировки нагрузки чем Mode-5. Обеспечивает балансировку нагрузки как исходящего так и входящего трафика.

Интересный вариант конфига для ноутбука:

```bash
# Define slaves   
auto eth0
iface eth0 inet manual
    bond-master bond0
    bond-primary eth0
    bond-mode active-backup

auto wlan0
iface wlan0 inet manual
    wpa-conf /etc/network/wpa.conf
    bond-master bond0
    bond-primary eth0
    bond-mode active-backup

# Define master
auto bond0
iface bond0 inet dhcp
    bond-slaves none
    bond-primary eth0
    bond-mode active-backup
    bond-miimon 100
```

#### 5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

- 8 адресов/6 хостов

```bash
e2sly4rz@DESKTOP-43OOABH:~$ ipcalc 172.16.16.0/29
Address:   172.16.16.0          10101100.00010000.00010000.00000 000
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Wildcard:  0.0.0.7              00000000.00000000.00000000.00000 111
=>
Network:   172.16.16.0/29       10101100.00010000.00010000.00000 000
HostMin:   172.16.16.1          10101100.00010000.00010000.00000 001
HostMax:   172.16.16.6          10101100.00010000.00010000.00000 110
Broadcast: 172.16.16.7          10101100.00010000.00010000.00000 111
Hosts/Net: 6                     Class B, Private Internet
```

- 32 подсети (256/8), например:

172.16.16.0/24 = 172.16.16.0/29 - 172.16.16.248/29

- Пример 3 подсетей внутри 10.10.10.0.24:

```bash
e2sly4rz@DESKTOP-43OOABH:~$ ipcalc -s 6 6 6 10.10.10.0/24
Address:   10.10.10.0           00001010.00001010.00001010. 00000000
Netmask:   255.255.255.0 = 24   11111111.11111111.11111111. 00000000
Wildcard:  0.0.0.255            00000000.00000000.00000000. 11111111
=>
Network:   10.10.10.0/24        00001010.00001010.00001010. 00000000
HostMin:   10.10.10.1           00001010.00001010.00001010. 00000001
HostMax:   10.10.10.254         00001010.00001010.00001010. 11111110
Broadcast: 10.10.10.255         00001010.00001010.00001010. 11111111
Hosts/Net: 254                   Class A, Private Internet

1. Requested size: 6 hosts
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Network:   10.10.10.0/29        00001010.00001010.00001010.00000 000
HostMin:   10.10.10.1           00001010.00001010.00001010.00000 001
HostMax:   10.10.10.6           00001010.00001010.00001010.00000 110
Broadcast: 10.10.10.7           00001010.00001010.00001010.00000 111
Hosts/Net: 6                     Class A, Private Internet

2. Requested size: 6 hosts
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Network:   10.10.10.8/29        00001010.00001010.00001010.00001 000
HostMin:   10.10.10.9           00001010.00001010.00001010.00001 001
HostMax:   10.10.10.14          00001010.00001010.00001010.00001 110
Broadcast: 10.10.10.15          00001010.00001010.00001010.00001 111
Hosts/Net: 6                     Class A, Private Internet

3. Requested size: 6 hosts
Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
Network:   10.10.10.16/29       00001010.00001010.00001010.00010 000
HostMin:   10.10.10.17          00001010.00001010.00001010.00010 001
HostMax:   10.10.10.22          00001010.00001010.00001010.00010 110
Broadcast: 10.10.10.23          00001010.00001010.00001010.00010 111
Hosts/Net: 6                     Class A, Private Internet

Needed size:  24 addresses.
Used network: 10.10.10.0/27
Unused:
10.10.10.24/29
10.10.10.32/27
10.10.10.64/26
10.10.10.128/25
```

#### 6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

100.64.0.0/26

#### 7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

**Linux**

```bash
# Просмотр arp таблицы
e2sly4rz@DESKTOP-43OOABH:~$ ip neigh
172.24.144.1 dev eth0 lladdr 00:15:5d:fe:6a:28 STALE

# Очистка кэша
e2sly4rz@DESKTOP-43OOABH:~$ sudo ip neigh flush all

# Удаление конкретного адреса
e2sly4rz@DESKTOP-43OOABH:~$ sudo ip neigh flush 172.24.144.1
```

**Windows**

```powershell
# Просмотр arp таблицы
PS C:\Users\e2sly> arp -a
Интерфейс: 192.168.4.252 --- 0x8
  адрес в Интернете      Физический адрес      Тип
  192.168.4.1           b8-69-f4-20-ca-a6     динамический
  192.168.4.229         50-85-69-ed-a1-26     динамический
  192.168.4.237         c8-28-32-2c-84-c7     динамический
  192.168.4.255         ff-ff-ff-ff-ff-ff     статический
  224.0.0.22            01-00-5e-00-00-16     статический
  224.0.0.250           01-00-5e-00-00-fa     статический
  224.0.0.251           01-00-5e-00-00-fb     статический
  224.0.0.252           01-00-5e-00-00-fc     статический
  239.255.102.18        01-00-5e-7f-66-12     статический
  239.255.255.250       01-00-5e-7f-ff-fa     статический
  239.255.255.251       01-00-5e-7f-ff-fb     статический
  255.255.255.255       ff-ff-ff-ff-ff-ff     статический

Интерфейс: 172.24.144.1 --- 0x2f
  адрес в Интернете      Физический адрес      Тип
  172.24.148.218        00-15-5d-de-a7-5f     динамический
  172.24.159.255        ff-ff-ff-ff-ff-ff     статический
  224.0.0.22            01-00-5e-00-00-16     статический
  224.0.0.250           01-00-5e-00-00-fa     статический
  224.0.0.251           01-00-5e-00-00-fb     статический
  224.0.0.252           01-00-5e-00-00-fc     статический
  239.255.255.250       01-00-5e-7f-ff-fa     статический
  239.255.255.251       01-00-5e-7f-ff-fb     статический

# Очистка кэша
PS C:\Users\e2sly> arp -d *

# Удаление конкретного адреса
PS C:\Users\e2sly> arp -d 192.168.4.237
```

 ---
# Задание для самостоятельной отработки (необязательно к выполнению)

#### 8. Установите эмулятор EVE-ng.

 Инструкция по установке - https://github.com/svmyasnikov/eve-ng

 Выполните задания на lldp, vlan, bonding в эмуляторе EVE-ng.

 - Давно хотел потестить EVE-ng, но к сожалению свободного пк нет, а с работающим Hyper-v он конфликтует.
